# Web-ларёк

Интернет-магазин с товарами для веб-разработчиков — Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

## Используемый стек
- HTML
- SCSS
- TypeScript
- Webpack

## Инструкция по сборке и запуску
После клонирования репозитория установите зависимости:
```sh
npm install
```

Для запуска проекта в режиме разработки выполните команду:
```sh
npm run start
```
Затем откройте браузер и перейдите по адресу `http://localhost:8080`.

## Архитектура
Проект построен на основе паттерна **MVP (Model-View-Presenter)**.
- **Model** отвечает за работу с данными и бизнес-логику, а именно загрузка данных по API, работа с данными, полученными от пользователей.
- **View** предоставляет интерфейс для пользователя и не содержит логики.
- **Presenter** получает пользовательские действия, обновляет модель и передаёт данные обратно во View.

### Структура проекта
```
src/                   # Исходные файлы проекта
├── components/        # Папка с JS-компонентами
│   └── base/         # Базовые классы
├── pages/
│   └── index.html    # HTML-файл главной страницы
├── styles/
│   └── styles.scss   # Корневой файл стилей
├── types/
│   └── types.ts      # Файл с типами данных
├── utils/
│   ├── constants.ts  # Файл с константами
│   └── utils.ts      # Файл с утилитами
└── index.ts          # Точка входа приложения
```

## Описание базовых классов

### `Api`
Класс для работы с сервером, выполняет запросы и обрабатывает ответы:
- `handleResponse(response: Response): Promise<object>` — обработчик ответа сервера, проверяет статус ответа и парсит данные.
- `get(uri: string)` — получает данные с сервера по указанному URI.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST')` — отправляет данные на сервер, поддерживает методы `POST`, `PUT`, `DELETE`.

### `EventEmitter`
Реализует паттерн **Observer** и управляет событиями, выступает в роли брокера событий:
- `on` — подписка на событие.
- `off` — отписка от события.
- `emit` — уведомление подписчиков.
- `onAll` — подписка на все события.
- `offAll` — сброс всех подписчиков.
- `trigger` — генерация события с аргументами для работы с внешними обработчиками.

## Классы Model

### `ApiModel`
Наследуется от `Api`, управляет взаимодействием с сервером, включая загрузку и отправку данных:
- `getListProductCard` — получает массив карточек товаров с сервера.
- `postOrderLot` — отправляет заказ пользователя и получает ответ от сервера.

### `BasketModel`
Отвечает за хранение и обработку данных корзины:
- `getCounter` — возвращает количество товаров в корзине.
- `getSumAllProducts` — вычисляет сумму всех товаров.
- `setSelectedCard` — добавляет товар в корзину.
- `deleteCardToBasket` — удаляет товар из корзины.
- `clearBasketProducts` — очищает корзину полностью.

### `DataModel`
Хранит данные товаров, загруженные с сервера:
- `setPreview` — сохраняет данные карточки товара, которую открыл пользователь.

### `FormModel`
Работает с пользовательскими данными, выполняет их валидацию:
- `setOrderAddress` — сохраняет адрес доставки.
- `validateOrder` — проверяет корректность адреса и способа оплаты.
- `setOrderData` — сохраняет телефон и email пользователя.
- `validateContacts` — проверяет корректность контактных данных.
- `getOrderLot` — формирует и возвращает заказ пользователя.

## Описание классов представления View

### `Basket`
Отвечает за отображение корзины и её содержимого:
- `renderHeaderBasketCounter` — обновляет количество товаров в корзине.
- `renderSumAllProducts` — отображает сумму товаров в корзине.

### `BasketItem`
Управляет отображением товаров в корзине:
- `setPrice` — форматирует цену товара в строку для корректного отображения.

### `Card`
Управляет отображением карточек товаров в магазине:
- `setText` — устанавливает текстовое содержимое в элемент.
- `cardCategory` — задаёт категорию товара в виде класса.
- `setPrice` — форматирует цену в строковое представление.

### `CardPreview`
Расширяет `Card`, предоставляет подробное описание товара:
- `notSale` — проверяет наличие цены, при её отсутствии ограничивает возможность покупки.

### `Order`
Обрабатывает ввод данных для оформления заказа в модальном окне:
- `paymentSelection` — устанавливает выбранный метод оплаты, визуально выделяя его.

### `Contacts`
Позволяет пользователю вводить контактные данные (телефон и email) перед оформлением заказа.

### `Modal`
Отвечает за управление модальными окнами приложения:
- `open` — открывает модальное окно.
- `close` — закрывает модальное окно.

### `Success`
Отображает сообщение об успешном оформлении заказа в модальном окне.